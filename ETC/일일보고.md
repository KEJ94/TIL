# 그룹웨어 일일보고 매크로  
미니콘다 설치 https://docs.anaconda.com/free/miniconda/
### anaconda prompt 실행  
```
python --version
```
> 파이썬 버전 확인
```
conda create -n venv python=3.11.1(설치된 파이썬 버전)
```
> 미니콘다 가상 환경 생성  
```
conda activate venv
pip install jupyter
pip install ipykernel
python -m ipykernel install --user --name venv --display-name "test"
```
> jupyter, ipykernel 설치  
```
pip install selenium
pip install webdriver_manager
```
> Selenium, ChromeDriver 설치
### 코드  
Jupyter Notebook 확장팩 설치, 파일.ipynb 생성  
```python
from selenium import webdriver
from selenium.webdriver.chrome.service import Service as ChromeService
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.common.by import By
import time
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC


dates = ["3/14", "3/15", "3/16", "3/17", "3/18"]
content = "업무내용"
gw_id = "그룹웨어ID"
gw_pw = "그룹웨어PW"

driver = webdriver.Chrome(service=ChromeService(ChromeDriverManager().install()))
driver.get('https://gw.jiran.com/app/approval/document/new/523/12808')

id_input = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "username")))
id_input.send_keys(gw_id)

password_input = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "password")))
password_input.send_keys(gw_pw)

login_button = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "login_submit")))
login_button.click()


for date in dates:
    time.sleep(3)
    subject_textarea = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "subject")))
    subject_textarea.send_keys(date + " 일일 업무 보고")

    for i in range(5,13):
        content_textarea = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, f"editorForm_{i}")))
        content_textarea.send_keys(content)

    temp_save_button = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "act_temp_save")))
    temp_save_button.click()

    temp_save_confirm_button = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.CSS_SELECTOR, ".btn_major_s")))
    temp_save_confirm_button.click()

    new_approval_button = WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.ID, "writeBtn")))
    new_approval_button.click()
    driver.get('https://gw.jiran.com/app/approval/document/new/523/12808')
    
driver.get('https://gw.jiran.com/app/approval/doclist/tempsave/all?page=0&offset=20&property=updatedAt&direction=desc&searchtype=&keyword=')

```
